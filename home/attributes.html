<html>
	<head>
		<link rel="stylesheet" href="cope.css">
	</head>
	<body>
		<a href="http://www.exedio.com/">
			<img src="exedio.png" class="exedio">
		</a>
		<h1><a href="index.html">COPE</a></h1>
		<div>Cope with Object Persistence</div>
		
		<h2>Attribute Trail</h2>
		<a href="http://sourceforge.net/">
			<img src="http://sourceforge.net/sflogo.php?group_id=152867&amp;type=1"
				class="sf" alt="SourceForge.net Logo" />
		</a>
		<div>
			While the <a href="intro.html>">initial trail</a>
			covered string attributes  only,
			this trails visits all kinds of other attributes
			as well as the more special features of string attributes.
		</div>
		<h3>Common Primitives</h3>
		<div>
			COPE provides attributes for all commonly used java primitives
			as well as for <tt>String</tt> and <tt>java.util.Date</tt>.
			This looks like this.
		</div>
<pre>
class Customer extends Item
{
   static final StringAttribute email =
       new StringAttribute(DEFAULT);
   static final DateAttribute registrationDate =
       new DateAttribute(DEFAULT);
   static final LongAttribute loginCounter =
       new LongAttribute(DEFAULT);
   static final IntegerAttribute subsequentLoginFailures =
       new IntegerAttribute(DEFAULT);
   static final DoubleAttribute priceCoefficient =
       new DoubleAttribute(DEFAULT);
}
</pre>
		<div>
			Run the instrumentor, and you get setters/getters for all
			the new attributes.
			Also the <i>default creation constructor</i>
			will have parameters for the initial values of these attributes.
		</div>
		<h3>Allowing Null</h3>
		<div>
			You may have asked yourself, what this <code>DEFAULT</code> argument
			of all attribute constructors means.
			Well, this means, that the attribute is <i>mandatory</i>,
			i.e. null values are not allowed for these attributes.
			If you don't like this, change it to <i>optional</i>.
		</div>
<pre>
static final LongAttribute loginCounter =
    new LongAttribute(OPTIONAL);
</pre>
		<div>
			When you run the instrumentor, you may notice 
			a few changes in the generated code.
			<ol>
				<li>
					The <i>default creation constructor</i> does not
					include a parameter for <tt>loginCounter</tt> anymore.
					This is because a value for <tt>loginCounter</tt> is not needed
					for constructing an instance of Customer anymore.
					If you still want to have <tt>loginCounter</tt> included into
					the <i>default creation constructor</i> add a
					<tt>@cope.initial</tt> tag to the attribute:
<pre>
/**
 * @cope.initial
 */
static final LongAttribute loginCounter =
    new LongAttribute(OPTIONAL);
</pre>
				</li>
				<li>
					The signature of the getter and setter for <tt>loginCounter</tt>
					changed.
					Before, it used the primitive type <tt>long</tt>
<pre>
long getLoginCounter() { ... }
void setLoginCounter(long loginCounter) { ... }
</pre>
					but now being optional it uses the wrapper class <tt>java.lang.Long</tt>.
<pre>
Long getLoginCounter() { ... }
void setLoginCounter(Long loginCounter) { ... }
</pre>
				</li>
			</ol>
				</li>
		</div>
		<h3>Default Values</h3>
		<div>
			What we did above with the login counter is probably not,
			what one would want in a real project.
			One would probably rather want to make it <i>mandatory</i>
			and initialize it to zero for any newly created customer.
			This can be specified by:
		</div>
<pre>
static final LongAttribute loginCounter =
    new LongAttribute(DEFAULT).defaultTo(0);
</pre>
		<div>
			In the instrumented code the type for setter/getter
			changes back to primitives again,
			but the <i>default creation constructor</i> does also
			not have a parameter for <tt>loginCounter</tt>.
		</div>
		<h3>Further Reading</h3>
		<div>
			This was the attribute trail of the cope tour.
			You may now proceed to trails:
			<ul>
				<li>transactions</li>
				<li>searching</li>
				<li>cope within a web application</li>
				<li>media</li>
				<li>understanding patterns</li>
			</ul>
		</div>
	</body>
</html>
