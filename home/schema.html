<html>
	<head>
		<title>COPE - Schema Trail</title>
		<meta name="keywords" content="Persistence, Java">
		<meta name="description" content="COPE - a persistence framework for Java">
		<link rel="stylesheet" href="cope.css">
		<style>
			img.console
			{
				border:0;
				margin:12pt;
			}
		</style>
	</head>
	<body>
		<a href="http://www.exedio.com/">
			<img src="exedio.png" class="exedio">
		</a>
		<h1><a href="index.html">COPE</a></h1>
		<div>Cope with Object Persistence</div>
		
		<h2>Schema Trail</h2>
		<a href="http://sourceforge.net/">
			<img src="http://sourceforge.net/sflogo.php?group_id=152867&amp;type=1"
				class="sf" alt="SourceForge.net Logo" />
		</a>
		<div>
			The <a href="webapplications.html#console">COPE Console</a>
			gathers various runtime information around COPE,
			such as cache statistics, connection pool, jdbc driver etc.
			This trail highlights it's schema evolution capabilities.
			It assumes that you have already deployed the <i>COPE Console</i> into your
			web application.
		</div>
		<h3>Inspection</h3>
		<div>
			You may want to know first,
			which database schema is created by COPE.
			Open up the Console in your browser,
			select the Tabulator <i>Schema</i>,
			and you will see something like this:
		</div>
		<img src="schema1.png" class="console" width="500" height="51">
		<div>
			The example model used to create this screenshot
			contains two types <tt>Customer</tt> and <tt>Order</tt>.
			Lets say, type <tt>Customer</tt> looks like this:
		</div>
<pre>
public class Customer extends Item
{
   static final StringField email = new StringField().<a href="api/com/exedio/cope/StringField.html#unique()">unique</a>();
}
</pre>
		<div>
			Now click on the table <i>Customer</i>
			to see the table details:
		</div>
		<img src="schema2.png" class="console" width="500" height="75">
		<div>
			This shows you two columns:
			<ul>
				<li>
					An integer column <tt>this</tt>
					holding the primary key for implementing object identity.
				</li>
				<li>
					A string column <tt>email</tt> holding the value of
					the field <tt>email</tt>.
			</ul>
			Following the columns there are the details of database constraints
			set up by COPE,
			but we won't deal with them in this trail.
		</div>
		<h3>Modification</h3>
		<div>
			Let's say you want to add a new field to your type:
		</div>
<pre>
public class Customer extends Item
{
   static final StringField email = new StringField().<a href="api/com/exedio/cope/StringField.html#unique()">unique</a>();
   <b>static final BooleanField blocked = new BooleanField();</b>
}
</pre>
		<div>
			If you want to adjust the database schema
			without loosing all your data,
			you have to issue some SQL like
			<tt>alter table Customer add column blocked integer</tt>.
			COPE can do that for you,
			but much more comfortable.
		</div>
		<div>
			If you start up the new application containing the new field,
			the <i>Schema</i> looks like this:
		</div>
		<img src="schema3.png" class="console" width="500" height="54">
		<div>
			The red color tells you,
			something is wrong with table <i>Customer</i>.
			Click on it for further details:
		</div>
		<img src="schema4.png" class="console" width="500" height="100">
		<div>
			Again, the red color tells you,
			that something is wrong with column <i>blocked</i>.
			In fact it is just missing, as expected.
			At the end of the line there is a checkbox named <i>create</i>.
			Select it (already done in this screenshot)
			and push the button <i>Apply</i> further up the page.
			The next screen looks like this:
		</div>
		<img src="schema5.png" class="console" width="500" height="101">
		<div>
			Column <i>blocked</i> does exist now,
			and therefore the red background turned to green.
			On the same page there is a log about COPE's activities:
		</div>
		<img src="schema5a.png" class="console" width="500" height="51">
		<div>
			This shows you, that column <i>blocked</i> of table
			<i>Customer</i> just has been created.
			At the same time this log is valid java source code,
			which can be used to achive the same effect programatically
			within your application.
		</div>
		<div>
			In a similar way you may deal with dropped columns,
			changed column types, new tables, changed constraints etc.
			It's recommended to check for red color
			in the <i>Schema</i> tab,
			whenever deploying a new version of your application
			on an existing database schema.
			If everything is green, then there is a very little chance,
			that application and database schema don't fit to each other.
		</div>
		<h3>Further Reading</h3>
		<div>
			After having a look at the COPE Console,
			you may want to go back to COPE itself.
			<ul>
				<li>
					<a href="searching.html">Searching Trail</a>
					gives you an introduction into the searching capabilities of cope.
				</li>
				<li>
					<a href="fields2.html">Field Reloaded Trail</a>
					covers all the more specific possibilities to store data with cope.
				</li>
			</ul>
		</div>
		<address>
			Copyright &copy; 2004-2007
			<a href="http://www.exedio.com/" target="_top">exedio</a>
			Gesellschaft f&uuml;r Softwareentwicklung mbH.
		</address>
	</body>
</html>
