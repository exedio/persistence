<html>
	<head>
		<title>COPE - Field Reloaded Trail</title>
		<meta name="keywords" content="Persistence, Java">
		<meta name="description" content="COPE - a persistence framework for Java">
		<link rel="stylesheet" href="cope.css">
	</head>
	<body>
		<a href="http://www.exedio.com/">
			<img src="exedio.png" class="exedio">
		</a>
		<h1><a href="index.html">COPE</a></h1>
		<div>Cope with Object Persistence</div>
		
		<h2>Field Reloaded Trail</h2>
		<a href="http://sourceforge.net/">
			<img src="http://sourceforge.net/sflogo.php?group_id=152867&amp;type=1"
				class="sf" alt="SourceForge.net Logo" />
		</a>
		<div>
			While the <a href="attributes.html">Field Trail</a>
			covered the most fundamental attributes only,
			this trails shows you some more special ways to store data with COPE.
			Although most of the features below are not attributes in a formal sense
			(means subclasses of class <a href="api/com/exedio/cope/Field.html">Field</a>)
			you don't have to care about this until you want to develop such features yourself.
		</div>
		<h3><a name="contents">Contents</a></h3>
		<ul>
			<li><a href="#hashes">Hashes</a></li>
			<li><a href="#attributelists">Field Lists</a></li>
			<li><a href="#attributemaps">Field Maps</a></li>
			<li><a href="#dayattributes">Day Fields</a></li>
			<li><a href="#further">Further Reading</a></li>
		</ul>
		<h3><a name="hashes">Hashes</a></h3>
		<div>
			If you want to store a string encoded by a hash algorithm,
			such as the password of the customer,
			then put the following into class <tt>Customer</tt>:
		</div>
<pre>
static final <a href="api/com/exedio/cope/pattern/MD5Hash.html">MD5Hash</a> password = new <a href="api/com/exedio/cope/pattern/MD5Hash.html#MD5Hash()">MD5Hash</a>();
</pre>
		<div>
			The instrumentor will generate a method for checking the password
			instead of a getter method:
		</div>
<pre>
boolean checkPassword(String password)
{
   return Customer.password.check(this, password);
}
</pre>
		<div>
			Using the super classes of <tt>MD5Hash</tt>
			you can choose any hash algorithm provided by the java.security package
			or even implement a custom algorithm.
		</div>
		<h3><a name="attributelists">Field Lists</a></h3>
		<div>
			Sometimes you may want to store multiple values for an attribute,
			such as multiple email addresses for the customer.
			This can be achieved with <i>attribute lists</i>:
		</div>
<pre>
static final <a href="api/com/exedio/cope/pattern/FieldList.html">FieldList</a>&lt;String&gt; emails =
    <a href="api/com/exedio/cope/pattern/FieldList.html">FieldList</a>.<a href="api/com/exedio/cope/pattern/FieldList.html#newList(com.exedio.cope.FunctionField)">newList</a>(new StringField());
</pre>
		<div>
			Internally this is implemented by an extra table in the database,
			so you can store lists of any size.
			If you are sure, that the list cannot a exceed a certain size,
			you may decide to use a <i>limited attribute list</i>:
		</div>
<pre>
static final <a href="api/com/exedio/cope/pattern/FieldListLimited.html">FieldListLimited</a>&lt;String&gt; emails =
    <a href="api/com/exedio/cope/pattern/FieldListLimited.html">FieldListLimited</a>.<a href="api/com/exedio/cope/pattern/FieldListLimited.html#newList(com.exedio.cope.FunctionField, int)">newList</a>(new StringField(OPTIONAL), 4);
</pre>
		<div>
			Internally there are 4 string attributes used for storing the elements of the list.
			If someone tries to store a list of more than 4 elements,
			an exception is thrown.
		</div>
		<h3><a name="attributemaps">Field Maps</a></h3>
		<div>
			Especially in international applications you may want to store multiple attribute values,
			such as one price of a product for each country or one description for each language.
			The following example specifies the latter:
		</div>
<pre>
static final <a href="api/com/exedio/cope/pattern/FieldMap.html">FieldMap</a>&lt;Language,String&gt; description =
    <a href="api/com/exedio/cope/pattern/FieldMap.html">FieldMap</a>.<a href="api/com/exedio/cope/pattern/FieldMap.html#newMap(com.exedio.cope.FunctionField, com.exedio.cope.FunctionField)">newMap</a>(newItemField(Language.class),
                        new StringField());
</pre>
		<div>
			The instrumentor will create appropriate methods for accessing the <i>attribute map</i>:
		</div>
<pre>
String getDescription(Language k)
{
    return Product.description.get(this, k);
}

void setDescription(Language k, String description)
{
    Product.description.set(this, k, description);
}
</pre>
		<div>
			This example assumes, that there is already a persistent item <tt>Language</tt>.
			If you decide to use use a fixed set of languages in your application,
			you may use an enum instead:
		</div>
<pre>
static enum Language { DE, EN, PL; }

static final <a href="api/com/exedio/cope/pattern/FieldMap.html">FieldMap</a>&lt;Language,String&gt; description =
    <a href="api/com/exedio/cope/pattern/FieldMap.html">FieldMap</a>.<a href="api/com/exedio/cope/pattern/FieldMap.html#newMap(com.exedio.cope.FunctionField, com.exedio.cope.FunctionField)">newMap</a>(newEnumField(Language.class),
                        new StringField());
</pre>
		<div>
			As with <i>attribute lists</i> this is implemented by an extra table in the database,
			so you can store maps of any size.
			If the key space of the map is limited to an enum,
			you may decide to use a <i>limited attribute map</i> instead:
		</div>
<pre>
static enum Language { DE, EN, PL; }

static final <a href="api/com/exedio/cope/pattern/FieldMapLimited.html">FieldMapLimited</a>&lt;Language,String&gt; description =
    <a href="api/com/exedio/cope/pattern/FieldMapLimited.html">FieldMapLimited</a>.<a href="api/com/exedio/cope/pattern/FieldMapLimited.html#newMap(java.lang.Class, com.exedio.cope.FunctionField)">newMap</a>(Language.class,
                        new StringField(OPTIONAL));
</pre>
		<div>
			Internally three string attributes
			<tt>nameDE</tt>, <tt>nameEN</tt>, <tt>namePL</tt>
			are used for storing the values of the map.
		</div>
		<h3><a name="dayattributes">Day Fields</a></h3>
		<div>
			Class <a href="api/com/exedio/cope/DateField.html">DateField</a>
			already stores time stamps with millisecond precision.
			However, sometimes you just want to store a day.
			Millisecond precision is then just an additional source for mistakes.
			Since the java runtime library does not provide a value class for this,
			COPE has to introduce it's own <a href="api/com/exedio/cope/util/Day.html">Day</a>.
			To define a <i>day attribute</i> within a type write:
		</div>
<pre>
static final <a href="api/com/exedio/cope/DayField.html">DayField</a> dateOfBirth = new <a href="api/com/exedio/cope/DayField.html#DayField()">DayField</a>();
</pre>
		<h3><a name="further">Further Reading</a></h3>
		<div>
			This was the advanced attribute trail of the cope tour.
			You may now proceed to trails:
			<ul>
				<li>
					<a href="transactions.html">Transactions Trail</a>
					tells you how to use transactions in cope.
				</li>
				<li>
					<a href="searching.html">Searching Trail</a>
					gives you an introduction into the searching capabilities of cope.
				</li>
				<li>
					<a href="webapplications.html">Web Application Trail</a>
					shows you the little differences when using cope within a web container.
				</li>
			</ul>
		</div>
		<address>
			Copyright &copy; 2004-2006
			<a href="http://www.exedio.com/" target="_top">exedio</a>
			Gesellschaft f&uuml;r Softwareentwicklung mbH.
		</address>
	</body>
</html>
